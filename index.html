<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confer√™ncia - Raz√£o</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
    <header>
        <h2>üìä Confer√™ncia de Saldos de Implanta√ß√£o</h2>
    </header>

    <div class="upload-section">
        <div class="input-group">
            <label for="fileDez">Raz√£o Dezembro (Saldo Atual)</label>
            <input type="file" id="fileDez" accept=".xlsx, .xls">
        </div>
        <div class="input-group">
            <label for="fileJan">Raz√£o Janeiro (Saldo Anterior)</label>
            <input type="file" id="fileJan" accept=".xlsx, .xls">
        </div>
    </div>

    <button id="btnProcessar" onclick="processarArquivos()">Gerar Confer√™ncia</button>

    <div id="resultadoArea" style="display:none;">
        <div id="statusBox" class="summary"></div>

        <div class="filter-section">
            <div class="filter-group">
                <span class="filter-label">Status:</span>
                <button id="btn-TODOS_STATUS" onclick="setFiltro('STATUS', 'TODOS_STATUS')" class="filter-btn active">Todas</button>
                <button id="btn-DIVERGENTE" onclick="setFiltro('STATUS', 'DIVERGENTE')" class="filter-btn">Divergentes</button>
                <button id="btn-OK" onclick="setFiltro('STATUS', 'OK')" class="filter-btn">Corretas</button>
            </div>
            <div class="filter-group">
                <span class="filter-label">Tipo:</span>
                <button id="btn-TODOS_TIPO" onclick="setFiltro('TIPO', 'TODOS_TIPO')" class="filter-btn active">Todas</button>
                <button id="btn-SINTETICA" onclick="setFiltro('TIPO', 'SINTETICA')" class="filter-btn">Sint√©ticas</button>
                <button id="btn-ANALITICA" onclick="setFiltro('TIPO', 'ANALITICA')" class="filter-btn">Anal√≠ticas</button>
                <div style="flex-grow: 1;"></div> 
                <button onclick="expandirTudo()" class="filter-btn">üìÇ Expandir Grupos</button>
                <button onclick="recolherTudo()" class="filter-btn">üìÅ Recolher Grupos</button>
            </div>
        </div>

        <table id="tabelaResultados">
            <thead>
                <tr>
                    <th>Tipo</th>
                    <th>Conta Cont√°bil</th>
                    <th>Descri√ß√£o (Dez)</th>
                    <th>C. Banc√°ria</th>
                    <th>Saldo Dez/24</th>
                    <th>Saldo Jan/25</th>
                    <th>Diferen√ßa</th>
                    <th>Situa√ß√£o</th>
                </tr>
            </thead>
            <tbody id="corpoTabela"></tbody>
            <tfoot id="peTabela"></tfoot>
        </table>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>